<html lang="en" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.indigo.min.css"/>
</head>
<body>

<div th:replace="~{fragment/nav :: top}"></div>
<main class="container" style="width: 500px;">

    <h1>로그인</h1>
    <form id="loginForm">
        <label for="username">아이디:</label>
        <input type="text" id="username" name="username">
        <label for="password">비밀번호:</label>
        <input type="password" id="password" name="password"><br>
        <button type="submit">로그인</button>
    </form>
    <button type="button" onclick="location.href='/signup'">회원가입</button>
    <br>
</main>

</body>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        if (document.getElementById("loginForm")) {
            document.getElementById("loginForm").addEventListener("submit", function (event) {
                event.preventDefault(); // 기본 동작인 폼 제출 방지

                // 폼 데이터를 FormData 객체로 가져옴
                const formData = new FormData(this);

                // AJAX 요청 보냄
                fetch("/login", {
                    method: "POST",
                    body: formData
                })
                    .then(response => {
                        if (response.ok) {
                            console.log("로그인 성공");

                            // 로그인 성공 알림을 표시합니다.
                            alert("로그인에 성공했습니다!");

                            // 로그인 성공 후 특정 URL로 리다이렉트합니다.
                            window.location.href = "/";
                        } else {
                            // 로그인이 실패했을 때
                            console.log("로그인 실패");
                            alert("아이디나 비밀번호를 확인해주세요");
                        }
                    })
                    .catch(error => {
                        console.error("Error:", error);
                    });
            });
        }
    });
</script>
</html>